<div id="bp_config">
  <div class="config-mark"></div>
  <div class="config-bg">
    <!-- 1.标题 -->
    <span style="font-size: 20px; display: block; margin-bottom: 15px;">
      <b>bilibili视频下载 参数设置</b>
      <b>
        <a href="javascript:;" id="reset_config"> [重置] </a>
        <a style="text-decoration: underline" href="javascript:;" id="show_help">&lt;通知/帮助&gt;</a>
      </b>
    </span>
    <!-- 2.内容，左右布局 -->
    <div style="display: flex; gap: 10px; height: 460px;">
      <!-- 左 -->
      <div style="flex-shrink: 0; border-right: 1px solid #ddd; padding-right: 10px; overflow-y: auto;">
        <ul style="list-style: none; padding: 0; margin: 0; font-size: 14px;">
          <li><a href="javascript:;" data-tab="basic" class="tab-link active">基本设置</a></li>
          <li><a href="javascript:;" data-tab="other" class="tab-link">其他设置</a></li>
          <!-- <li><a href="javascript:;" data-tab="about" class="tab-link">关于脚本</a></li> -->
        </ul>
      </div>
      <!-- 右 -->
      <div id="tab-content" style="flex: 1; overflow-y: auto; padding-left: 10px; font-size: 14px;">
        <!-- 1. 基本设置 -->
        <div class="tab-panel" data-id="basic">
          <div style="margin: 2% 0">
            <label>请求地址：</label>
            <input id="base_api" style="width: 40%" />&nbsp;&nbsp;&nbsp;&nbsp;
            <label>请求方式：</label>
            <select id="request_type">
              <option value="auto">自动判断</option>
              <option value="local">本地请求</option>
              <option value="remote">远程请求</option>
            </select><br />
            <small>注意：普通使用请勿修改；默认使用混合请求</small>
          </div>
          <div style="margin: 2% 0">
            <label>视频格式：</label>
            <select id="format">
              <option value="mp4">MP4</option>
              <option value="flv">FLV</option>
              <option value="dash">DASH</option>
            </select>&nbsp;&nbsp;&nbsp;&nbsp;
            <label>切换CDN：</label>
            <select id="host_key">
              {{host_key_options}}
            </select><br />
            <small>注意：无法选择MP4清晰度；建议特殊地区或播放异常时切换（自行选择合适线路）</small>
          </div>
          <div style="margin: 2% 0">
            <label>视频质量：</label>
            <select id="video_quality">
              {{video_quality_options}}
            </select><br />
            <small>提示：脚本识别错误时可手动设置请求的视频质量参数</small>
          </div>
          <!-- 下载方式 -->
          <div style="margin: 2% 0">
            <label>下载方式：</label>
            <select id="download_type">
              <option value="a">URL链接</option>
              <option value="web">Web请求</option>
              <option value="aria">Aria2命令</option>
              <option value="blob">Blob请求</option>
              <option value="blob_merge">Blob合并</option>
              <option value="rpc">RPC接口</option>
            </select>&nbsp;&nbsp;&nbsp;&nbsp;
            <label>AriaNg地址：</label>
            <input id="ariang_host" style="width: 40%" /><br />
            <small>提示：建议使用RPC请求下载；非HTTPS或非本地RPC域名使用AriaNg下载</small>
          </div>
          <div style="margin: 2% 0">
            <label>RPC配置：[ 域名 : 端口 | 路径 | 密钥 ]</label><br />
            <input id="rpc_domain" placeholder="ws://192.168.1.1" style="width: 25%" /> :
            <input id="rpc_port" placeholder="6800" style="width: 10%" /> |
            <input id="rpc_path" placeholder="/jsonrpc" style="width: 20%" /> |
            <input id="rpc_token" placeholder="未设置不填" style="width: 15%; color: transparent;"
              onFocus="this.style.color='black';" onBlur="this.style.color='transparent';" /><br />
            <small>注意：RPC默认使用Motrix（需要安装并运行）下载，其他软件请修改参数</small>
          </div>
          <!-- 自动下载 -->
          <div style="margin: 2% 0">
            <label>自动下载：</label>
            <select id="auto_download">
              <option value="0">关闭</option>
              <option value="1">开启</option>
            </select><br />
            <small>说明：请求地址成功后将自动点击下载视频按钮</small>
          </div>
          <div style="margin: 2% 0">
            <label>授权状态：</label>
            <select id="auth" disabled>
              <option value="0">未授权</option>
              <option value="1">已授权</option>
            </select>
            <a class="setting-context" href="javascript:;" id="show_login">扫码授权</a>
            <a class="setting-context" href="javascript:;" id="show_login_2">网页授权</a>
            <a class="setting-context" href="javascript:;" id="show_logout">取消授权</a>
            <a class="setting-context" href="javascript:;" id="show_login_help">授权说明</a>
          </div>
        </div>

        <!-- 2. 其他设置 -->
        <div class="tab-panel" data-id="other" style="display:none;">
          <!-- RPC参数 -->
          <div style="margin: 2% 0">
            <label>RPC下载目录：</label>
            <input id="rpc_dir" placeholder="留空使用默认目录" style="width: 70%" />
          </div>
          <div style="margin: 2% 0">
            <label>AriaNg下载目录：</label>
            <input id="ariang_dir" placeholder="留空使用默认目录" style="width: 70%" />
          </div>
          <!-- Aria2参数 -->
          <div style="margin: 2% 0">
            <span>[Aria2参数]</span><br />
            <label>最大连接：</label>
            <select id="aria2c_connection_level">
              <option value="min">1</option>
              <option value="mid">8</option>
              <option value="max">16</option>
            </select>&nbsp;&nbsp;&nbsp;&nbsp;
            <label>附加参数：</label>
            <input id="aria2c_addition_parameters" placeholder="见Aria2c文档" style="width: 40%" /><br />
            <small>说明：用于配置Aria2命令下载方式的参数</small>
          </div>

          <div style="margin: 2% 0">
            <label>强制换源：</label>
            <select id="replace_force">
              <option value="0">关闭</option>
              <option value="1">开启</option>
            </select>&nbsp;&nbsp;&nbsp;&nbsp;
            <label>弹幕速度：</label>
            <input id="danmaku_speed" style="width: 10%" /> s&nbsp;&nbsp;&nbsp;&nbsp;
            <label>弹幕字号：</label>
            <input id="danmaku_fontsize" style="width: 10%" /> px&nbsp;&nbsp;&nbsp;&nbsp;
            <small>说明：使用请求到的视频地址在DPlayer进行播放；弹幕速度为弹幕滑过DPlayer的时间</small>
          </div>
          <div style="margin: 2% 0">
            <label>UI超时时间：</label>
            <input id="show_ui_timeout" style="width: 10%"> s
            <small>说明：脚本初始化时，超时没有正常显示UI的检查时间，数值填写正整数</small>
          </div>
          <div style="margin: 2% 0">
            <label>UI加载提示：</label>
            <select id="show_ui_confirm">
              <option value="0">关闭</option>
              <option value="1">开启</option>
            </select>
            <small>说明：脚本初始化UI时，如果检测到页面异常会进行弹窗提示是否手动加载</small>
          </div>

          <div style="margin: 2% 0">
            <label>UI强制加载：</label>
            <select id="show_ui_confirm_load_force">
              <option value="0">关闭</option>
              <option value="1">开启</option>
            </select>
            <small>说明：启用UI加载超时弹窗时，自动确认强制加载UI，可能导致页面异常</small>
          </div>
        </div>

        <!-- 3. ... -->
        <!-- <div class="tab-panel" data-id="xxx">
        </div> -->
      </div>
    </div>
    <!-- 3.保存按钮 -->
    <div style="text-align: right; margin-top: 20px;">
      <button class="setting-button" id="save_config">确定</button>
    </div>
  </div>

  <style>
    #bp_config {
      opacity: 0;
      display: none;
      position: fixed;
      inset: 0px;
      top: 0px;
      left: 0px;
      width: 100%;
      height: 100%;
      z-index: 10000;
    }

    #bp_config .config-bg {
      position: absolute;
      background: rgb(255, 255, 255);
      border-radius: 10px;
      padding: 20px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 700px;
      max-width: 90vw;
      max-height: 90vh;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      z-index: 10001;
    }

    #bp_config .config-mark {
      width: 100%;
      height: 100%;
      position: fixed;
      top: 0;
      left: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 10000;
    }

    #bp_config .setting-button {
      width: 120px;
      height: 40px;
      border-width: 0px;
      border-radius: 3px;
      background: #1e90ff;
      cursor: pointer;
      outline: none;
      color: white;
      font-size: 17px;
    }

    #bp_config .setting-button:hover {
      background: #5599ff;
    }

    #bp_config .setting-context {
      margin: 0 1%;
      color: blue;
    }

    #bp_config .setting-context:hover {
      color: red;
    }

    /* 菜单样式 */
    #bp_config .tab-link {
      display: block;
      padding: 8px 10px;
      margin: 4px 0;
      border-radius: 4px;
      color: #333;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.2s;
    }

    #bp_config .tab-link:hover {
      background: #eef5ff;
    }

    #bp_config .tab-link.active {
      background: #1e90ff;
      color: white;
    }

    /* 小提示文字 */
    #bp_config small {
      color: #666;
      font-size: 12px;
      margin-top: 4px;
      display: block;
    }

    /* 表单对齐 */
    #bp_config label {
      font-weight: 500;
      min-width: 60px;
      display: inline-block;
    }

    #bp_config input,
    #bp_config select {
      padding: 4px 6px;
      border: 1px solid #ccc;
      border-radius: 3px;
    }

    #bp_config input:focus,
    #bp_config select:focus {
      border-color: #1e90ff;
      outline: none;
    }
  </style>
</div>